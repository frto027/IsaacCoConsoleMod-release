# 联机控制台模组（CoConsole）使用说明

[English version](Readme.en.md)

仅适配游戏版本1.9.7.12，游戏版本更新后将失效。此模组不承诺后续更新。

该插件仅在以下条件下工作：
1. 联机人数大于1人。
2. 所有玩家（包括自己）均发送"cmd ok"同意使用插件。

如果有新版本（几乎不会有），可能会带有安全更新。这种情况下你应该及时更新（或移除插件）以避免自己被黑客攻击。插件在开启游戏后第一次使用时会向房间内所有人发送自己的版本号，看到别人有新版本就说明你该更新了。

## 安装方法

将userenv.dll复制到游戏目录下（isaac-ng.exe所在目录），这不会覆盖任何文件。移除此dll即可删除模组。

此模组与中文模组冲突。

## "cmd ok"
在聊天界面输入"cmd ok"同意使用控制台，输入"cmd no"撤销同意，插件会自动记忆每个玩家steamID的同意状态，更换房间无需重新同意。
仅当房间内所有玩家都同意使用控制台时（包括你自己），才可以发送控制台指令。
如果你是中途加入游戏的，也需要其它人发送"cmd ok"，让插件看到才可以发送指令。

## 兼容性
此插件需要房间内的所有玩家都安装补丁后才能使用，否则（在未安装补丁的玩家发送"cmd ok"同意之后）强制使用会导致游戏卡死。

## 控制台指令
在聊天窗口发送"cmd <指令>"即可执行。例如"cmd spawn 5.100"。部分指令（如涉及到具体某个玩家的giveitem）会导致游戏失去同步，需要避免使用。不要在房间里用，进游戏再操作。

**你应当理解，由控制台指令导致的游戏后果不属于Bug，不要向Nicalis报告这些情况，除非你能证明在正常游戏中能够遭遇，或这个bug的修复是对Nicalis有好处的。**

**不要向Nicalis报告任何因控制台指令直接导致的desync，他们不加这个班。** ~~也别向我报告，我不想加班。~~

## 已知设计缺陷
已知的意思就是这些缺陷不会被修复。

- 每帧一条指令，不要多发，不要多人同时使用指令，否则可能导致游戏失去同步掉线。
- 插件未对丢包进行兜底处理，如果存在丢包则必然导致游戏失去同步掉线。
- 控制台输出不会打印出来
- 模组不会影响指令历史，repeat指令无法工作

## 游戏限制与安全性
- 已禁用lua指令，避免出现安全问题。
- 已禁用每日挑战。将光标移动到每日挑战上会导致游戏直接退出。
- 已禁用游戏的错误日志上传功能（未确认官方是否启用此功能）。

## 技术原理
该模组基于游戏的联机代码增加了一个自定义的控制台消息类型，并完成后续开发，不会带来明显额外的安全风险。
但你应该了解，任何联机场景下的功能开发都会不可避免的引入安全风险，可能导致你的电脑遭受黑客攻击。
此模组引入的未知安全风险与nicalis完全无关。

由于上述原因，此模组源码不便公开，如有需要可与作者探讨。

